{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport { upload, userEdit, pwdEdit } from '../../api/userApi';\nexport default {\n  data: function data() {\n    return {\n      userInfo: {},\n      activeName: '1',\n      user: {\n        userid: '',\n        imgUrl: '',\n        userName: '',\n        tel: '',\n        mail: '',\n        sex: '2'\n      },\n      pwd: {\n        userid: '',\n        oldPassword: '',\n        newPassword: ''\n      },\n      okpwd: ''\n    };\n  },\n  created: function created() {\n    this.userInfo = this.$store.state.userInfo;\n    this.user.userid = this.$store.state.userInfo.userid;\n    this.pwd.userid = this.$store.state.userInfo.userid;\n    this.user.imgUrl = this.$store.state.userInfo.imgUrl;\n    this.user.userName = this.$store.state.userInfo.userName;\n    this.user.tel = this.$store.state.userInfo.tel;\n    this.user.mail = this.$store.state.userInfo.mail;\n    this.user.sex = this.$store.state.userInfo.sex;\n  },\n  methods: {\n    //上传头像\n    handleAvatarSuccess: function handleAvatarSuccess(parame) {\n      var _this = this;\n      var formData = new FormData();\n      formData.append('file', parame.file);\n      upload(formData).then(function (res) {\n        if (res.code == 200) {\n          _this.user.imgUrl = res.data.imgUrl;\n        }\n      });\n    },\n    //上传头像之前的校验\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === 'image/jpeg';\n      var isLt2M = file.size / 1024 / 1024 < 2;\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    //保存基本资料按钮\n    handleSubmit: function handleSubmit() {\n      var _this2 = this;\n      userEdit(this.user).then(function (res) {\n        if (res.code == 200) {\n          localStorage.setItem('userInfo', JSON.stringify(res.data));\n          _this2.$message.error(res.message);\n          _this2.$router.go(0);\n        }\n      });\n    },\n    //保存密码按钮\n    handlePwdSubmit: function handlePwdSubmit() {\n      var _this3 = this;\n      if (this.okpwd != this.pwd.newPassword) {\n        this.$message.error('两次密码不一致');\n        return;\n      }\n      pwdEdit(this.pwd).then(function (res) {\n        if (res.code == 200) {\n          localStorage.setItem('userInfo', JSON.stringify(res.data));\n          _this3.$router.push('/user');\n          _this3.$message.error(res.message);\n        }\n      });\n    },\n    //关闭按钮\n    handleClos: function handleClos() {\n      this.$router.push('/home');\n    }\n  }\n};","map":{"version":3,"names":["upload","userEdit","pwdEdit","data","userInfo","activeName","user","userid","imgUrl","userName","tel","mail","sex","pwd","oldPassword","newPassword","okpwd","created","$store","state","methods","handleAvatarSuccess","parame","_this","formData","FormData","append","file","then","res","code","beforeAvatarUpload","isJPG","type","isLt2M","size","$message","error","handleSubmit","_this2","localStorage","setItem","JSON","stringify","message","$router","go","handlePwdSubmit","_this3","push","handleClos"],"sources":["src/views/user/index.vue"],"sourcesContent":["<template>\n    <div class=\"user-page\">\n        <!-- 左侧 -->\n        <el-card class=\"box-card left\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>个人信息</span>\n            </div>\n            <div class=\"centent two\">\n                <el-upload class=\"avatar-uploader\" \n                    action=\"\" \n                    :show-file-list=\"false\" \n                    :http-request=\"handleAvatarSuccess\"\n                    :before-upload=\"beforeAvatarUpload\"\n                >\n                    <img v-if=\"user.imgUrl\" :src=\"user.imgUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload>\n            </div>\n            <div class=\"centent\">\n                <span>\n                    <i class=\"el-icon-user\"></i>\n                    用户名称\n                </span>\n                <span>{{userInfo.userName}}</span>\n            </div>\n            <div class=\"centent\">\n                <span>\n                    <i class=\"el-icon-mobile-phone\"></i>\n                    手机号码\n                </span>\n                <span>{{userInfo.tel}}</span>\n            </div>\n            <div class=\"centent\">\n                <span>\n                    <i class=\"el-icon-message\"></i>\n                    用户邮箱\n                </span>\n                <span>{{userInfo.mail}}</span>\n            </div>\n            <div class=\"centent\">\n                <span>\n                    <i class=\"el-icon-user-solid\"></i>\n                    所属角色\n                </span>\n                <span>{{userInfo.role}}</span>\n            </div>\n            <div class=\"centent\">\n                <span>\n                    <i class=\"el-icon-date\"></i>\n                    创建日期\n                </span>\n                <span>{{userInfo.creatDate}}</span>\n            </div>\n        </el-card>\n\n\n\n\n        <!-- 右侧 -->\n        <el-card class=\"box-card right\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>基本资料</span>\n            </div>\n            <div>\n                <el-tabs v-model=\"activeName\">\n                    <el-tab-pane label=\"基本资料\" name=\"1\">\n                        <el-form label-width=\"80px\">\n                            <el-form-item label=\"用户昵称\">\n                                <el-input v-model=\"user.userName\" size=\"small\" clearable placeholder=\"请输入用户昵称\"></el-input>\n                            </el-form-item>\n                            <el-form-item label=\"手机号码\">\n                                <el-input v-model=\"user.tel\" size=\"small\" clearable placeholder=\"请输入手机号码\"></el-input>\n                            </el-form-item>\n                            <el-form-item label=\"邮箱\">\n                                <el-input v-model=\"user.mail\" size=\"small\" clearable placeholder=\"请输入邮箱\"></el-input>\n                            </el-form-item>\n                            <el-form-item label=\"性别\">\n                                <el-radio v-model=\"user.sex\" label=\"1\">男</el-radio>\n                                <el-radio v-model=\"user.sex\" label=\"2\">女</el-radio>\n                            </el-form-item>\n\n                            <el-form-item>\n                                <el-button type=\"primary\" size=\"small\" @click=\"handleSubmit\">保存</el-button>\n                                <el-button type=\"danger\" size=\"small\" @click=\"handleClos\">关闭</el-button>\n                            </el-form-item>\n                        </el-form>\n                    </el-tab-pane>\n\n\n                    <el-tab-pane label=\"修改密码\" name=\"2\">\n                        <el-form label-width=\"80px\">\n                            <el-form-item label=\"旧密码\">\n                                <el-input v-model=\"pwd.oldPassword\" size=\"small\" clearable placeholder=\"请输入旧密码\"></el-input>\n                            </el-form-item>\n                            <el-form-item label=\"新密码\">\n                                <el-input v-model=\"pwd.newPassword\" size=\"small\" clearable placeholder=\"请输入新密码\"></el-input>\n                            </el-form-item>\n                            <el-form-item label=\"确认密码\">\n                                <el-input v-model=\"okpwd\" size=\"small\" clearable placeholder=\"请确认密码\"></el-input>\n                            </el-form-item>\n\n                            <el-form-item>\n                                <el-button type=\"primary\" size=\"small\" @click=\"handlePwdSubmit\">保存</el-button>\n                                <el-button type=\"danger\" size=\"small\" @click=\"handleClos\">关闭</el-button>\n                            </el-form-item>\n                        </el-form>\n                    </el-tab-pane>\n                </el-tabs>\n            </div>\n        </el-card>\n    </div>\n</template>\n\n<script>\nimport { upload, userEdit, pwdEdit } from '../../api/userApi'\nexport default {\n    data() {\n        return {\n            userInfo: {},\n            activeName: '1',\n            user:{\n                userid: '',\n                imgUrl: '',\n                userName: '',\n                tel: '',\n                mail: '',\n                sex: '2',\n            },\n            pwd:{\n                userid: '',\n                oldPassword: '',\n                newPassword: '',\n            },\n            okpwd: ''\n        }\n    },\n\n    created() {\n        this.userInfo = this.$store.state.userInfo\n        this.user.userid = this.$store.state.userInfo.userid\n        this.pwd.userid = this.$store.state.userInfo.userid\n        this.user.imgUrl = this.$store.state.userInfo.imgUrl\n        this.user.userName = this.$store.state.userInfo.userName\n        this.user.tel = this.$store.state.userInfo.tel\n        this.user.mail = this.$store.state.userInfo.mail\n        this.user.sex = this.$store.state.userInfo.sex\n    },\n    methods: {\n        //上传头像\n        handleAvatarSuccess(parame) {\n            let formData = new FormData()\n            formData.append('file', parame.file)\n            upload(formData).then(res =>{\n                if(res.code == 200){\n                    this.user.imgUrl = res.data.imgUrl\n                }\n            })\n        },\n\n        //上传头像之前的校验\n        beforeAvatarUpload(file) {\n            const isJPG = file.type === 'image/jpeg';\n            const isLt2M = file.size / 1024 / 1024 < 2;\n\n            if (!isJPG) {\n                this.$message.error('上传头像图片只能是 JPG 格式!');\n            }\n            if (!isLt2M) {\n                this.$message.error('上传头像图片大小不能超过 2MB!');\n            }\n            return isJPG && isLt2M;\n        },\n        \n        //保存基本资料按钮\n        handleSubmit(){\n            userEdit(this.user).then(res =>{\n                if(res.code == 200){\n                    localStorage.setItem('userInfo', JSON.stringify(res.data));\n                    this.$message.error(res.message);\n                    this.$router.go(0)\n                }\n            })\n        },\n\n        //保存密码按钮\n        handlePwdSubmit(){\n            if(this.okpwd != this.pwd.newPassword){\n                this.$message.error('两次密码不一致');\n                return\n            }\n            pwdEdit(this.pwd).then(res =>{\n                if(res.code == 200){\n                    localStorage.setItem('userInfo', JSON.stringify(res.data));\n                    this.$router.push('/user')\n                    this.$message.error(res.message);\n                }\n            })\n        },\n\n        //关闭按钮\n        handleClos(){\n            this.$router.push('/home')\n        },\n    }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.user-page {\n    display: flex;\n    .left {\n        width: 25%;\n        .centent {\n            display: flex;\n            justify-content: space-between;\n            border-bottom: 1px solid #d4d4d4;\n            padding: 8px 0;\n            font-size: 14px;\n            .avatar-uploader .el-upload {\n                border: 1px dashed #d9d9d9;\n                border-radius: 6px;\n                cursor: pointer;\n                position: relative;\n                overflow: hidden;\n            }\n            .avatar-uploader .el-upload:hover {\n                border-color: #409EFF;\n            }\n            .avatar-uploader-icon {\n                font-size: 28px;\n                color: #8c939d;\n                width: 120px;\n                height: 120px;\n                line-height: 120px;\n                text-align: center;\n            }\n            .avatar {\n                width: 120px;\n                height: 120px;\n                border-radius: 50%;\n                display: block;\n            }\n            .avatar-uploader{\n                width: 120px;\n                height: 120px;\n                border: 1px solid #000;\n                border-radius: 50%;\n            }\n        }\n        .two{\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        }\n    }\n    .right {\n        width: 75%;\n        margin-left: 20px;\n    }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}